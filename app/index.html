<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Axiom ID — Proof of Identity on Solana</title>
  <meta name="description" content="Axiom ID — identity proofs and verifiable credentials built on Solana." />
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#9aa6b2;--accent:#00e5a8}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{background:linear-gradient(180deg,#071023 0%,#071827 100%);color:#e6eef6;padding:40px}
    .wrap{max-width:980px;margin:0 auto}
    header{display:flex;align-items:center;gap:16px}
    .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#00b4ff);display:flex;align-items:center;justify-content:center;color:#052028;font-weight:700}
    h1{margin:0;font-size:28px}
    p.lead{color:var(--muted);margin-top:6px}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:24px;margin-top:28px}
    .card{background:var(--card);padding:20px;border-radius:12px;color:#d9eef7}
    .muted{color:var(--muted);font-size:13px}
    .cta{display:inline-block;background:var(--accent);color:#052028;padding:10px 14px;border-radius:10px;font-weight:700;text-decoration:none}
    .stat{display:flex;gap:12px;align-items:center}
    footer{margin-top:40px;color:var(--muted);font-size:13px}
    pre{background:#04111a;padding:12px;border-radius:8px;overflow:auto}
    form .row{display:flex;gap:8px;margin-top:8px}
    input,button,select{font:inherit}
    input[type="email"], input[type="text"], input[type="tel"]{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit}
    .small{font-size:12px;color:var(--muted)}
    .success{color:#8ee3b9}
    .error{color:#ff8a8a}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">A</div>
      <div>
        <h1>Axiom ID</h1>
        <p class="lead">Verifiable, composable identity on Solana — proofs, attestation, and quick developer UX.</p>
      </div>
    </header>

    <div class="grid">
      <div>
        <div class="card">
          <h2>Quick demo</h2>
          <p class="muted">This is the starter landing page for the Axiom ID frontend. Below are ideas and a minimal local integration snippet you can wire to your dApp.</p>

          <h3 style="margin-top:18px">Suggested Landing Content</h3>
          <ul class="muted">
            <li>Hero tagline + short explanation of the identity primitives (proofs, revocations, attestations).</li>
            <li>Key features: On-chain attestations, off-chain proofs, wallet-first UX, privacy-preserving hashes.</li>
            <li>Quick stats panel: total attestations, active issuers, verifications per day (placeholders).</li>
            <li>Developer section: install & run commands, code snippets to integrate the JS client.</li>
            <li>Calls-to-action: Try demo (connect wallet), Read docs, Request an invite.</li>
          </ul>

          <h3 style="margin-top:12px">Local dev snippet (example)</h3>
          <pre><code>// Using @coral-xyz/anchor & @solana/web3.js
const provider = anchor.AnchorProvider.local();
anchor.setProvider(provider);
const idl = await anchor.Program.fetchIdl("AXIOM_ID_PROGRAM", provider.connection);
// load program and call methods
</code></pre>

          <h3 style="margin-top:12px">Starter CTA</h3>
          <a class="cta" href="#collect">Join waitlist / Try demo</a>
        </div>

        <div class="card" style="margin-top:18px">
          <h3>Suggested data to collect on launch</h3>
          <ul class="muted">
            <li>Number of issued attestations (by issuer)</li>
            <li>Number of successful verifications</li>
            <li>Categories of attestations (KYC-lite, email, phone, proof-of-domain)</li>
            <li>Latency & success rate of verification flows</li>
            <li>Opt-in analytics for demo users (aggregate & anonymized)</li>
          </ul>
        </div>

      </div>

      <aside>
        <div class="card">
          <h3>Project status</h3>
          <p class="muted">Build: <strong id="build-status">unknown</strong></p>
          <p class="muted">Program IDL: <strong id="idl-status">missing</strong></p>
          <p class="muted">Localnet: <strong id="localnet-status">stopped</strong></p>

          <h3 style="margin-top:12px">Developer quick commands</h3>
          <pre><code>cd /path/to/axiom_id
rustup override set stable
export BUILD_WITH_DOCKER=0
anchor build -v
solana-test-validator --reset &amp;
anchor deploy
anchor test</code></pre>

          <p class="muted">Place this page in <code>/app/index.html</code> and serve it with any static server for quick demos.</p>
        </div>
      </aside>
    </div>

    <section id="collect" style="margin-top:24px">
      <div class="card">
        <h3>Join the waitlist / Demo access</h3>
        <p class="muted">We only ask for what's necessary. Your email will be used to notify you about demos. You can optionally connect your wallet to tie a demo account to your address.</p>

        <form id="email-form" novalidate>
          <label class="small">Email</label>
          <input id="email" type="email" placeholder="you@domain.com" required />

          <div class="row" style="margin-top:8px">
            <input id="fullName" type="text" placeholder="Full name (optional)" />
          </div>

          <div class="row" style="margin-top:8px">
            <input id="phone" type="tel" placeholder="Phone (optional)" />
          </div>

          <div style="margin-top:8px">
            <label class="small"><input id="consent" type="checkbox" required /> I agree to be contacted about product updates (required)</label>
          </div>

          <div class="row" style="margin-top:12px">
            <button id="submit-btn" class="cta" type="submit">Join waitlist</button>
            <button id="connect-wallet" type="button" class="cta" style="background:#00b4ff">Connect Wallet</button>
          </div>

          <p id="form-status" class="small muted" style="margin-top:8px"></p>
        </form>

        <div style="margin-top:12px" class="muted small">
          <strong>Data Privacy:</strong> We recommend using an email service provider (Mailchimp, Posthog, or Formspree) or your backend endpoint to capture submissions. Never store unencrypted PII on-chain. By submitting, you consent to data processing according to our privacy policy.
        </div>
      </div>
    </section>

    <footer>
      Built for the Axiom ID project — edit this page to reflect your product messaging. When ready, wire up a React/Vue frontend and replace the placeholders with live metrics and wallet flows.
    </footer>
  </div>

  <!-- Include solana web3 via unpkg (IIFE build). Using a CDN here for quick demo only. -->
  <script src="https://unpkg.com/@solana/web3.js@1.69.0/lib/index.iife.js"></script>
  <!-- Optional: Supabase client (UMD) for quick demo serverless storage (replace keys below) -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js/dist/umd/supabase.min.js"></script>
   <script>
     // Minimal client-side logic: connect Phantom wallet, capture email form and send to a placeholder endpoint.
     (function(){
      // Optional integrations (set these values or replace with your deployment-specific values)
      // To enable PostHog analytics, add your API key here:
      const POSTHOG_API_KEY = ''; // e.g. 'phc_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'
      // To enable Supabase storage, add your project URL and anon key here:
      const SUPABASE_URL = ''; // e.g. 'https://your-project.supabase.co'
      const SUPABASE_ANON_KEY = ''; // e.g. 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'
      let posthog = null;
      let supabaseClient = null;
      
      // Email validation regex
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      
      if(POSTHOG_API_KEY){
        // load posthog.js dynamically
        (function(){
          var ph = document.createElement('script'); ph.type='text/javascript'; ph.async=true;
          ph.src = 'https://cdn.posthog.com/libs/posthog.js';
          ph.onload = function(){ 
            if (window.posthog) {
              window.posthog.init(POSTHOG_API_KEY, {api_host: 'https://app.posthog.com'});
              posthog = window.posthog;
              console.log('PostHog initialized');
            }
          };
          document.head.appendChild(ph);
        })();
      }
      if(SUPABASE_URL && SUPABASE_ANON_KEY && window.supabase){
        try{ 
          supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
          console.log('Supabase client initialized');
        }catch(e){ 
          console.warn('Supabase init failed', e); 
        }
      }
       const form = document.getElementById('email-form');
       const emailInput = document.getElementById('email');
       const nameInput = document.getElementById('fullName');
       const phoneInput = document.getElementById('phone');
       const consent = document.getElementById('consent');
       const status = document.getElementById('form-status');
       const submitBtn = document.getElementById('submit-btn');
       const connectBtn = document.getElementById('connect-wallet');
       let connectedPubkey = null;

       async function postSignup(payload){
         // Default: Formspree endpoint or your backend
         const FORM_ENDPOINT = 'https://formspree.io/f/YOUR_FORM_ID'; // <- REPLACE WITH YOUR ACTUAL FORMSPREE ENDPOINT
        try{
          const res = await fetch(FORM_ENDPOINT, {
            method: 'POST',
            headers: {'Content-Type':'application/json'},
            body: JSON.stringify(payload)
          });
          return res;
        }catch(err){
          console.error('Form submission error:', err);
          throw err;
        }
       }

      form.addEventListener('submit', async (e)=>{
        e.preventDefault();
        status.className = 'small muted';
        status.textContent = '';

        const email = (emailInput.value||'').trim();
        // Enhanced email validation
        if(!email || !emailRegex.test(email)){ 
          status.className='small error'; 
          status.textContent='Please enter a valid email address.'; 
          return; 
        }
        if(!consent.checked){ 
          status.className='small error'; 
          status.textContent='Consent is required to join the waitlist.'; 
          return; 
        }

        submitBtn.disabled = true;
        submitBtn.textContent = 'Submitting...';

        const payload = {
          email, 
          name: (nameInput.value||'').trim(), 
          phone: (phoneInput.value||'').trim(), 
          wallet: connectedPubkey, 
          ts: new Date().toISOString()
        };

        try{
          console.log('Submitting payload:', payload);
          
          // Preferred: store in Supabase if configured
          if(supabaseClient){
            console.log('Attempting Supabase insert...');
            const { data, error } = await supabaseClient.from('waitlist').insert([payload]).select();
            if(error){
              console.warn('Supabase insert error:', error);
              throw new Error('Supabase insert failed: ' + error.message);
            }else{
              console.log('Supabase insert successful:', data);
              if(posthog) {
                posthog.capture('waitlist_submitted', payload);
                console.log('PostHog event sent: waitlist_submitted');
              }
              status.className='small success';
              status.textContent = 'Thanks — you are on the waitlist!';
              form.reset(); 
              connectedPubkey = null; 
              return;
            }
          }

          // Try the demo endpoint; if not configured, save to localStorage as fallback
          console.log('Attempting Formspree submission...');
          const res = await postSignup(payload);
          console.log('Formspree response:', res);
          
          if(res && (res.ok || res.status===200 || res.status===201)){
            if(posthog) {
              posthog.capture('waitlist_submitted', payload);
              console.log('PostHog event sent: waitlist_submitted');
            }
            status.className='small success';
            status.textContent = 'Thanks — you are on the waitlist!';
            // optional: clear
            form.reset();
            connectedPubkey = null;
          }else{
            // Fallback for demo: store client-side
            console.log('Falling back to localStorage...');
            localStorage.setItem('axiom_waitlist', JSON.stringify(payload));
            if(posthog) {
              posthog.capture('waitlist_saved_local', payload);
              console.log('PostHog event sent: waitlist_saved_local');
            }
            status.className='small muted';
            status.textContent = 'Saved locally (demo mode). To send emails, configure FORM_ENDPOINT or Supabase.';
          }
         }catch(err){
           console.error('Submission error:', err);
          // fallback store
          localStorage.setItem('axiom_waitlist', JSON.stringify(payload));
          if(posthog) {
            posthog.capture('waitlist_error', {error: (err && err.message)||String(err), ...payload});
            console.log('PostHog event sent: waitlist_error');
          }
          status.className='small error';
          status.textContent = 'Error occurred; data saved locally. Details: ' + (err.message || 'Unknown error');
         }finally{
           submitBtn.disabled = false;
           submitBtn.textContent = 'Join waitlist';
         }
       });

      // Wallet connect (Phantom)
      async function connectWallet(){
        try{
          status.className='small muted';
          status.textContent = 'Connecting wallet...';
          
          if(window.solana && window.solana.isPhantom){
            console.log('Phantom wallet detected, requesting connection...');
            const resp = await window.solana.connect();
            connectedPubkey = resp.publicKey.toString();
            console.log('Wallet connected:', connectedPubkey);
            status.className='small success';
            status.textContent = 'Connected: ' + (connectedPubkey.slice(0,6) + '...' + connectedPubkey.slice(-4));
            return connectedPubkey;
          }else{
            // Try using web3.js provider fallback
            status.className='small error';
            status.textContent = 'Phantom wallet not found. Please install Phantom or use a compatible wallet.';
            console.warn('Phantom wallet not found');
          }
        }catch(err){
          console.error('Wallet connection error:', err);
          status.className='small error';
          status.textContent = 'Wallet connection failed: ' + (err.message || 'Unknown error');
        }
      }

      connectBtn.addEventListener('click', connectWallet);

      // Small helper: show placeholder stats (replace with real metrics)
      document.getElementById('build-status').textContent = 'unknown (local)';
      document.getElementById('idl-status').textContent = 'check idl/ folder';

      // Configuration instructions
      console.log('Axiom ID Waitlist Form Loaded');
      console.log('To configure:');
      console.log('1. Set FORM_ENDPOINT to your actual Formspree endpoint');
      console.log('2. Set SUPABASE_URL and SUPABASE_ANON_KEY for Supabase integration');
      console.log('3. Set POSTHOG_API_KEY for analytics tracking');
    })();
   </script>
 </body>
 </html>
